---
import Layout from '../layouts/Layout.astro';
import yaml from 'js-yaml';
import fs from 'node:fs';
import path from 'node:path';

// Load signatories
const signatoriesPath = path.join(process.cwd(), 'src/data/signatories.yaml');
const signatoriesFile = fs.readFileSync(signatoriesPath, 'utf-8');
const signatoriesData = yaml.load(signatoriesFile) as { signatories: Array<{
  name: string;
  url?: string;
  title?: string;
  org?: string;
}> };

const signatories = signatoriesData.signatories || [];
---

<Layout title="Use What Works - A Manifesto">
  <header>
    <h1>Use What Works</h1>
    <span class="hashtag">#UseWhatWorks</span>
  </header>

  <article class="manifesto-content">
    <blockquote>
      We are a group of practitioners who believe in choosing proven solutions over building bespoke frameworks.
    </blockquote>

    <hr>

    <h2>Our Principles</h2>

    <p><strong>1. Stand on the shoulders of giants</strong></p>
    <p>Before writing custom code, look for battle-tested libraries and frameworks that solve your problem. Thousands of hours of development, testing, and real-world usage have gone into open source solutions. Respect that investment.</p>

    <p><strong>2. Your business logic is unique; your infrastructure is not</strong></p>
    <p>Focus your custom code on what makes your product different. Authentication, routing, state management, and data fetching have been solved. Use those solutions.</p>

    <p><strong>3. Maintenance is a feature</strong></p>
    <p>Every line of code you write is a line you must maintain. Libraries maintained by active communities share that burden across thousands of developers.</p>

    <p><strong>4. NIH syndrome is expensive</strong></p>
    <p>"Not Invented Here" costs more than pride. It costs time, money, and opportunity. The best engineers know when to build and when to integrate.</p>

    <p><strong>5. Boring technology is a compliment</strong></p>
    <p>Proven, stable, "boring" tools let you ship faster and sleep better. Save innovation for where it creates customer value.</p>

    <p><strong>6. Documentation matters</strong></p>
    <p>Well-documented solutions accelerate onboarding and reduce tribal knowledge. Popular libraries come with tutorials, Stack Overflow answers, and community support.</p>

    <p><strong>7. Evaluate, then commit</strong></p>
    <p>Take time to choose the right tool. Once chosen, commit fully. Constant second-guessing and premature optimization waste more time than careful initial selection.</p>

    <hr>

    <h2>What This Means in Practice</h2>
    <ul>
      <li>Use React, Vue, or Svelte instead of building a custom reactive framework</li>
      <li>Use PostgreSQL, MySQL, or MongoDB instead of building a custom database</li>
      <li>Use Auth0, Clerk, or Supabase Auth instead of rolling your own authentication</li>
      <li>Use Stripe or PayPal instead of building payment processing</li>
      <li>Use established CSS frameworks or design systems instead of starting from scratch</li>
      <li>Use proven testing frameworks instead of custom test harnesses</li>
    </ul>

    <hr>

    <h2>Join Us</h2>
    <p>If you believe in building on proven foundations rather than reinventing wheels, add your name to the signatories below.</p>
  </article>

  <section class="signatories">
    <h2>Signatories</h2>
    <p class="signatory-count">
      {signatories.length} {signatories.length === 1 ? 'person has' : 'people have'} signed this manifesto
    </p>
    <ul class="signatory-list">
      {signatories.map((person) => (
        <li class="signatory">
          {person.url ? (
            <a href={person.url} target="_blank" rel="noopener" class="signatory-name">
              {person.name}
            </a>
          ) : (
            <span class="signatory-name">{person.name}</span>
          )}
          {(person.title || person.org) && (
            <span class="signatory-details">
              {person.title}{person.title && person.org && ' at '}{person.org}
            </span>
          )}
        </li>
      ))}
    </ul>

    <div class="cta">
      <h2>Sign the Manifesto</h2>
      <p>Add your name by submitting a pull request on GitHub.</p>
      <a href="https://github.com/UseWhatWorks/manifesto/edit/main/src/data/signatories.yaml" class="btn">
        Add Your Signature
      </a>
    </div>
  </section>
</Layout>

<style>
  header {
    text-align: center;
    margin-bottom: 2rem;
  }

  .manifesto-content blockquote {
    font-size: 1.25rem;
    font-style: italic;
    color: var(--color-text-muted);
    border-left: 4px solid var(--color-accent);
    padding-left: 1.5rem;
    margin: 2rem 0;
  }

  .manifesto-content hr {
    border: none;
    border-top: 1px solid var(--color-border);
    margin: 2.5rem 0;
  }

  .signatories {
    margin-top: 4rem;
    padding-top: 2rem;
    border-top: 1px solid var(--color-border);
  }

  .signatory-count {
    color: var(--color-text-muted);
    font-size: 0.95rem;
  }

  .signatory-list {
    list-style: none;
    padding: 0;
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
    gap: 1rem;
    margin: 1.5rem 0;
  }

  .signatory {
    padding: 1rem;
    background: var(--color-border);
    border-radius: 8px;
    margin: 0;
  }

  .signatory-name {
    font-weight: 600;
    display: block;
  }

  .signatory-details {
    font-size: 0.85rem;
    color: var(--color-text-muted);
    display: block;
    margin-top: 0.25rem;
  }
</style>
